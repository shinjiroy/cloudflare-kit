# cloudflare-kit

CloudflareのCDN用Terraform構成案

## 管理方法

Cloudflareはドメイン毎にZoneという物を作ります。  
選択するプラン、契約内容によって、例えば検証環境と本番環境で異なるZoneを作ることが難しい場合があります。  
難しい場合に検証環境と本番環境用ドメインを準備したい場合は、同じZoneに設定を共存させることになります。

方針としては以下の2つが上げられます。

1. 本番用(`hoge.com`)Zoneと検証用(`testhoge.com`)Zoneを作って良い場合
2. `hoge.com`用Zoneしか作れない場合

1の場合は、`/environments`以下に`/production`,`/testing`のようなディレクトリを作成する。  
2の場合は、`/domains`以下に`/hoge_com`のようなディレクトリを作成することになります。

1,2の方針が途中で変わったらimport作業がとても大変ですが、頑張りましょう。

## 構成

CDNがCloudflare、オリジンがCloudflare以外の想定とし、  
オリジンがアプリケーションサーバー(動的コンテンツを配信)とS3等のストレージサーバー(静的コンテンツを配信)があり、パスによって変わるものとします。
